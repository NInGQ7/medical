# 医疗设备参数智能融合系统

## 📖 项目简介

医疗设备参数智能融合系统是一个基于Python的数据处理工具，用于自动融合多个供应商提供的医疗设备技术参数数据，并智能判定供应商数据是否达标。

## ✨ 主要功能

### 1. 多策略智能融合
- **精确匹配融合**: 标准化处理后完全相同的数据
- **高相似度融合**: 使用多种相似度算法（Fuzz、Token Sort、Token Set）
- **中等相似度融合**: 适用于部分相似的数据（相似度≥60%）
- **语义匹配融合**: 基于医疗领域同义词库的语义理解
- **数字范围融合**: 自动创建数值范围，支持单位转换
- **误差结构融合**: 针对含±符号的误差数据，采用最大数值
- **多值参数融合**: 处理USB×3、A/B/M等多值格式

### 2. 参数名称驱动的融合策略
- 根据参数名称自动选择最合适的融合策略
- 支持数字类、文本类、多值类、尺寸类参数
- 可配置的参数规则（PARAM_RULES）

### 3. 增强的数字处理
- 科学记数法支持（3e6 → 3000000）
- 单位自动转换（3000W → 3KW）
- 复合单位处理（m/s、L/min）
- 比较符号统一（> → ≥，< → ≤）
- 括号内单位优先级：括号内单位 > 括号外单位
- 噪声数字过滤

### 4. 供应商达标判定
- **蓝色**: 供应商数据达标
- **灰色**: 供应商无数据
- **黄色**: 需人工审核

#### 判定逻辑
- **包含判断**: 供应商数据包含融合参数则达标
- **比较符号判断**: 支持≥、≤、>、<等符号的达标判定
- **文本语义等价**: 二维↔2D、三维↔3D、彩色↔彩屏等
- **数字范围判断**: 值是否在范围内
- **多值维度判断**: 每个维度是否达标

### 5. 智能化特性
- **参数预处理**: 自动拆分整合参数
- **冲突词检测**: 彩色vs黑白、触摸vs非触摸
- **语义等价识别**: 支持中英文、单位、维度等语义等价
- **详细日志**: 记录融合过程和统计信息

## 🚀 快速开始

### 环境要求
- Python 3.7+
- 依赖包：pandas, openpyxl, fuzzywuzzy, jieba

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行方式

#### 方式1: 命令行模式
```bash
python main.py input.xlsx
```

#### 方式2: GUI图形界面
```bash
python gui_app.py
```
或直接双击 `启动GUI.bat`

## 📁 项目结构

```
medical-device-fusion/
├── config/               # 配置文件
│   ├── config.py        # 主配置和参数规则(PARAM_RULES)
│   └── synonyms.py      # 医疗领域同义词库
├── src/                 # 核心代码
│   ├── fusion_engine.py           # 融合引擎
│   ├── numeric_processor.py       # 数字处理器
│   ├── text_processor.py          # 文本处理器
│   └── parameter_preprocessor.py  # 参数预处理器
├── main.py              # 命令行主程序
├── gui_app.py           # GUI图形界面
├── requirements.txt     # 依赖包列表
└── README.md           # 项目说明
```

## 📝 输入格式

Excel文件格式：
- **第1列**: 技术参数名称
- **第2列及以后**: 各供应商数据

## 📊 输出格式

系统会在输入文件同目录生成融合结果Excel文件，包含：
- **说明行**: 颜色说明和注意事项（黄色背景、加粗、14磅字体）
- **原始列**: 保留所有原始供应商数据
- **融合数据列**: 智能融合后的结果
- **融合类型列**: 使用的融合策略
- **合并数据列**: 所有参数融合结果汇总
- **颜色标记**: 
  - 蓝色=供应商数据达标
  - 灰色=供应商无数据
  - 黄色=需人工审核

## ⚙️ 配置说明

### PARAM_RULES 参数规则配置

在 `config/config.py` 中可以配置参数融合规则：

```python
PARAM_RULES = {
    # 数字类参数
    '电池容量': {'type': 'numeric', 'unit': 'mAh', 'allow_range': True, 'tolerance': 0.05},
    
    # 文本类参数
    '探头类型': {'type': 'text', 'similarity_threshold': 0.8},
    
    # 多值类参数
    '接口': {'type': 'multi_value', 'separator': '×', 'keys': ['USB', 'HDMI'], 'merge_mode': 'max'},
}
```


